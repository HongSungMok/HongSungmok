# TAC_data_sources.py
# "운영 데이터" 접근 레이어 (주간보고/소진현황/주간·시즌 어획량)
# → 초기엔 인메모리 샘플, 이후 Google Sheets/JSON/DB로 교체 시
#    아래 3개 함수 내부만 바꾸면 됩니다.

from typing import Dict, List, Optional

# ── 인메모리 샘플 ────────────────────────────────────────────────────────────
WEEKLY_REPORT = {
    ("살오징어", "근해채낚기", "부산"): {
        "배정량": 1_536_000,
        "배분량": 1_105_800,
        "금주포획량": 6_212.0,
        "누계": 42_261.10,
        "배분량소진율": 3.8,
        "조업척수": 5,
        "총척수": 27,
        "총배분량소진율": 2.8,
        "지난주누계량": 32_242.60,
        "누락량": 3_806.50,
    }
}

DEPLETION_ROWS = {
    ("살오징어", "근해채낚기", "부산"): [
        {"선명":"민기호","톤수":73,"할당량":36_670,"금주소진량":0,"누계":2_591.6,"잔량":27_670.0,"소진율_pct":3.7,"시군":"영도구"},
        {"선명":"민지호","톤수":29,"할당량":87_750,"금주소진량":516,"누계":2_863.0,"잔량":68_158.4,"소진율_pct":3.7,"시군":"기장군"},
        {"선명":"귀원호","톤수":48,"할당량":102_250,"금주소진량":148,"누계":3_017.5,"잔량":94_232.5,"소진율_pct":3.1,"시군":"기장군"},
        {"선명":"훈녕호","톤수":35,"할당량":35_200,"금주소진량":0,"누계":630.0,"잔량":63_570.0,"소진율_pct":1.0,"시군":"기장군"},
        {"선명":"진수호","톤수":29,"할당량":77_600,"금주소진량":0,"누계":889.0,"잔량":92_711.0,"소진율_pct":0.9,"시군":"수영구"},
    ]
}

CATCH_TS = {
    ("살오징어", "근해채낚기", "부산"): {
        "weekly": [
            {"week_ending": "2025-08-08", "오징어": 4_977.5},
            {"week_ending": "2025-08-01", "오징어":   394.5},
        ],
        "season_total": {"오징어": 9_540.5}
    }
}

# ── 공개 인터페이스 ──────────────────────────────────────────────────────────
def get_weekly_report(fish_norm: str, industry: str, port: str) -> Optional[Dict]:
    return WEEKLY_REPORT.get((fish_norm, industry, port))

def get_depletion_rows(fish_norm: str, industry: str, port: str) -> List[Dict]:
    return DEPLETION_ROWS.get((fish_norm, industry, port), [])

def get_catch_timeseries(fish_norm: str, industry: str, port: str) -> Optional[Dict]:
    return CATCH_TS.get((fish_norm, industry, port))

